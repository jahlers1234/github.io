<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ahlers Arcade Scoreboard</title>
    <style>
        body {
            font-family: 'Orbitron', sans-serif;
            background: linear-gradient(45deg, #1a1a1a, #002244, #1a1a1a);
            background-size: 400%;
            animation: gradientShift 15s ease infinite;
            margin: 0;
            padding: 10px;
            color: #fff;
            overflow: hidden;
            zoom: 0.9; /* Zoom out by 10% */
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .container {
            width: 98vw;
            height: 95vh;
            margin: 10px auto;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 0 25px #00ffcc, inset 0 0 12px #00aaff;
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
        }
        .cyber-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M0 0v100h100V0H0zm5 5h90v90H5V5z" fill="none" stroke="rgba(0,255,204,0.2)" stroke-width="0.5"/></svg>') repeat;
            opacity: 0.3;
            z-index: 0;
            animation: gridPulse 10s infinite;
        }
        @keyframes gridPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.5; }
        }
        h1 {
            text-align: center;
            color: #00ffcc;
            font-size: 34px;
            margin: 10px 0;
            text-shadow: 0 0 15px #00ffcc, 0 0 25px #00aaff;
            animation: glow 2s ease-in-out infinite;
        }
        @keyframes glow {
            0%, 100% { text-shadow: 0 0 15px #00ffcc, 0 0 25px #00aaff; }
            50% { text-shadow: 0 0 25px #00ffcc, 0 0 35px #00aaff; }
        }
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        .tab {
            padding: 12px 30px;
            cursor: pointer;
            background: rgba(0, 170, 255, 0.2);
            margin: 0 6px;
            border-radius: 8px;
            font-size: 18px;
            transition: all 0.3s;
            border: 1px solid #00ffcc;
            text-shadow: 0 0 5px #00ffcc;
        }
        .tab:hover {
            background: #00aaff;
            box-shadow: 0 0 15px #00aaff;
            transform: translateY(-2px);
        }
        .tab.active {
            background: #00ffcc;
            color: #000;
            box-shadow: 0 0 20px #00ffcc;
            text-shadow: none;
        }
        .league {
            display: none;
            flex-grow: 1;
            max-height: 80vh;
            overflow-y: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .league::-webkit-scrollbar {
            display: none;
        }
        .league.active {
            display: block;
        }
        #nfl-scores, #mlb-scores {
            overflow-y: auto;
            max-height: 80vh;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        #nfl-scores::-webkit-scrollbar, #mlb-scores::-webkit-scrollbar {
            display: none;
        }
        .section {
            margin-bottom: 20px;
        }
        .section h2 {
            color: #00ffcc;
            font-size: 24px;
            text-align: center;
            text-shadow: 0 0 15px #00ffcc;
        }
        .game {
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.8);
            margin: 15px 0;
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #00aaff;
            box-shadow: 0 0 15px rgba(0, 170, 255, 0.5);
            transition: transform 0.2s;
            min-height: 180px;
        }
        .game:hover {
            transform: scale(1.02);
        }
        .teams-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }
        .team {
            display: flex;
            align-items: center;
            width: 45%;
            font-size: 20px;
        }
        .team.away {
            justify-content: flex-end;
        }
        .team img {
            width: 45px;
            height: 45px;
            margin: 0 15px;
            filter: drop-shadow(0 0 5px #00ffcc);
        }
        .rank, .record {
            font-size: 14px;
            margin: 0 5px;
            color: #00ffcc;
            text-shadow: 0 0 5px #00ffcc;
        }
        .score {
            font-size: 28px;
            font-weight: bold;
            margin: 0 25px;
            color: #00ffcc;
            text-shadow: 0 0 10px #00ffcc;
            transition: transform 0.3s;
        }
        .score.live {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }
        .info-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            width: 100%;
        }
        .status {
            text-align: center;
            font-size: 18px;
            color: #00aaff;
            text-shadow: 0 0 5px #00aaff;
            flex: 1;
        }
        .channel, .time {
            font-size: 16px;
            color: #fff;
            text-shadow: 0 0 5px #00aaff;
            flex: 1;
            text-align: center;
        }
        .stats {
            text-align: center;
            font-size: 16px;
            color: #fff;
            margin-top: 8px;
            text-shadow: 0 0 5px #00aaff;
        }
        .diamond {
            width: 80px;
            height: 60px;
            margin: 10px auto;
        }
        .base {
            fill: none;
            stroke: #fff;
            stroke-width: 2;
        }
        .base.active {
            fill: #00ffcc;
        }
        .no-games {
            text-align: center;
            color: #aaa;
            font-size: 18px;
            text-shadow: 0 0 5px #aaa;
        }
        #fullscreen-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            font-size: 0.8em;
            padding: 5px 10px;
            background: transparent;
            border: none;
            color: #FF2079;
            cursor: pointer;
            text-shadow: 0 0 5px #00FF9F;
            z-index: 2;
        }
        #fullscreen-btn:hover {
            color: #00FF9F;
        }
        #ticker {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #1C2526;
            color: #00FF9F;
            padding: 5px;
            overflow: hidden;
            white-space: nowrap;
            font-size: 1em;
            z-index: 2;
        }
        #ticker span {
            display: inline-block;
            animation: ticker 102s linear infinite; /* Set to 102s */
        }
        @keyframes ticker {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        @media (max-width: 768px) {
            .game { min-height: 140px; }
            .team { width: 100%; justify-content: center; margin: 8px 0; }
            .team.away { justify-content: center; }
            .score { font-size: 24px; }
            .rank, .record { font-size: 12px; }
            h1 { font-size: 30px; }
            .tab { font-size: 16px; padding: 10px 25px; }
            .team img { width: 40px; height: 40px; }
            .league { max-height: 75vh; }
            #nfl-scores, #mlb-scores { max-height: 75vh; }
            .channel, .time, .status { font-size: 14px; }
            .stats { font-size: 14px; }
            .diamond { width: 70px; height: 50px; }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="cyber-grid"></div>
    <button id="fullscreen-btn">toggle fullscreen</button>
    <div class="container">
        <h1>Ahlers Arcade Scoreboard</h1>
        <div class="tabs">
            <div class="tab active" data-league="ncaa">NCAA</div>
            <div class="tab" data-league="nfl">NFL</div>
            <div class="tab" data-league="mlb">MLB</div>
        </div>
        <div id="ncaa" class="league active">
            <div class="section" id="ncaa-current">
                <h2>Live Now</h2>
                <div id="ncaa-current-games"></div>
            </div>
            <div class="section" id="ncaa-upcoming">
                <h2>Upcoming Big Games</h2>
                <div id="ncaa-upcoming-games"></div>
            </div>
        </div>
        <div id="nfl" class="league">
            <div id="nfl-scores"></div>
        </div>
        <div id="mlb" class="league">
            <div id="mlb-scores"></div>
        </div>
    </div>
    <div id="ticker"><span>Loading news ticker...</span></div>
    <script>
        // Fullscreen toggle
        const fullscreenBtn = document.getElementById('fullscreen-btn');
        fullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => console.log('Fullscreen error:', err));
                fullscreenBtn.textContent = 'exit fullscreen';
            } else {
                document.exitFullscreen();
                fullscreenBtn.textContent = 'toggle fullscreen';
            }
        });

        const leagues = {
            ncaa: 'football/college-football',
            nfl: 'football/nfl',
            mlb: 'baseball/mlb'
        };

        let scrollAnimationFrame = null;

        function startAutoScroll(containerId, duration) {
            if (scrollAnimationFrame) cancelAnimationFrame(scrollAnimationFrame);
            const container = document.getElementById(containerId);
            if (!container) {
                console.error(`Container not found for ${containerId}`);
                return;
            }
            // Force reflow to ensure scrollHeight is accurate
            container.scrollTop = 0;
            const scrollDistance = container.scrollHeight - container.clientHeight;
            console.log(`Starting scroll for ${containerId}: scrollHeight=${container.scrollHeight}, clientHeight=${container.clientHeight}, scrollDistance=${scrollDistance}, duration=${duration}ms`);
            if (scrollDistance <= 0) {
                console.log(`No scrolling needed for ${containerId}`);
                return;
            }

            const startTime = performance.now();
            let lastUpdate = startTime;

            function scrollStep(timestamp) {
                if (timestamp - lastUpdate < 16) { // Cap at ~60fps
                    scrollAnimationFrame = requestAnimationFrame(scrollStep);
                    return;
                }
                lastUpdate = timestamp;
                const elapsed = timestamp - startTime;
                const progress = Math.min(elapsed / duration, 1); // Linear easing
                container.scrollTop = scrollDistance * progress;
                if (progress < 1) {
                    scrollAnimationFrame = requestAnimationFrame(scrollStep);
                } else {
                    container.scrollTop = 0; // Reset to top
                    lastUpdate = startTime = timestamp; // Reset timing for loop
                    scrollAnimationFrame = requestAnimationFrame(scrollStep);
                }
            }

            scrollAnimationFrame = requestAnimationFrame(scrollStep);
        }

        function stopAutoScroll() {
            if (scrollAnimationFrame) {
                cancelAnimationFrame(scrollAnimationFrame);
                console.log('Scroll stopped');
            }
        }

        function formatEasternTime(dateString, league) {
            const date = new Date(dateString);
            const time = date.toLocaleTimeString('en-US', {
                timeZone: 'America/New_York',
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            });
            const dateStr = date.toLocaleDateString('en-US', { timeZone: 'America/New_York', month: 'short', day: 'numeric' });
            return league === 'mlb' ? `First Pitch: ${dateStr} at ${time}` : `Kickoff: ${dateStr} at ${time}`;
        }

        function formatRecord(record) {
            return record ? `(${record})` : '';
        }

        function formatDateForESPN(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}${month}${day}`;
        }

        async function fetchNCAAGames() {
            const currentDate = new Date();
            currentDate.setHours(22, 32, 0, 0); // 10:32 PM EDT, September 1, 2025
            const futureDate = new Date(currentDate);
            futureDate.setDate(currentDate.getDate() + 7);

            const currentContainer = document.getElementById('ncaa-current-games');
            const upcomingContainer = document.getElementById('ncaa-upcoming-games');

            // Fetch current day's live games
            try {
                const currentUrl = `https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard?dates=${formatDateForESPN(currentDate)}&groups=80`;
                const currentResponse = await fetch(currentUrl);
                if (!currentResponse.ok) throw new Error(`HTTP ${currentResponse.status}`);
                const currentData = await currentResponse.json();
                const currentGames = currentData.events?.filter(event => event.status.type.state === 'in') || [];

                currentContainer.innerHTML = currentGames.length === 0 ? '<p class="no-games">No live Division I games today.</p>' : '';
                currentGames.forEach(event => {
                    const gameDiv = document.createElement('div');
                    gameDiv.className = 'game';
                    const homeTeam = event.competitions[0].competitors.find(c => c.homeAway === 'home');
                    const awayTeam = event.competitions[0].competitors.find(c => c.homeAway === 'away');
                    const awayLogo = awayTeam.team.logo || 'https://via.placeholder.com/40';
                    const homeLogo = homeTeam.team.logo || 'https://via.placeholder.com/40';
                    const scoreClass = 'score live';
                    const awayRank = awayTeam.rank ? `#${awayTeam.rank}` : '';
                    const homeRank = homeTeam.rank ? `#${homeTeam.rank}` : '';
                    const awayRecord = formatRecord(awayTeam.records ? awayTeam.records[0]?.summary : '');
                    const homeRecord = formatRecord(homeTeam.records ? homeTeam.records[0]?.summary : '');
                    const away = `<div class="team away"><img src="${awayLogo}" alt="${awayTeam.team.displayName} logo"><span class="rank">${awayRank}</span>${awayTeam.team.displayName}<span class="record">${awayRecord}</span> <span class="${scoreClass}">${awayTeam.score || 0}</span></div>`;
                    const vs = `<div class="vs">@</div>`;
                    const home = `<div class="team"><img src="${homeLogo}" alt="${homeTeam.team.displayName} logo"><span class="rank">${homeRank}</span>${homeTeam.team.displayName}<span class="record">${homeRecord}</span> <span class="${scoreClass}">${homeTeam.score || 0}</span></div>`;
                    const channel = event.competitions[0].broadcasts?.[0]?.names?.join(', ') || 'TBD';
                    const situation = event.competitions[0].situation || {};
                    const quarter = situation.period ? `Q${situation.period}` : (event.status.type.description.toLowerCase().includes('overtime') ? 'OT' : event.status.type.shortDetail || 'Live');
                    const timeRemaining = event.status.displayClock || '';
                    const status = quarter;
                    const stats = timeRemaining ? `${timeRemaining}` : '';
                    gameDiv.innerHTML = `
                        <div class="teams-container">${away} ${vs} ${home}</div>
                        <div class="info-container">
                            <div class="status">${status}</div>
                            <div class="channel">Channel: ${channel}</div>
                        </div>
                        ${stats ? `<div class="stats">${stats}</div>` : ''}
                    `;
                    currentContainer.appendChild(gameDiv);
                });
                if (document.getElementById('ncaa').classList.contains('active')) {
                    startAutoScroll('ncaa', 252000); // 252s for NCAA
                }
            } catch (error) {
                console.error('Error fetching NCAA live games:', error);
                currentContainer.innerHTML = '<p class="no-games">Error fetching live games.</p>';
            }

            // Fetch upcoming big games (ESPN API)
            try {
                const upcomingUrl = `https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard?dates=${formatDateForESPN(currentDate)}-${formatDateForESPN(futureDate)}&groups=80`;
                const upcomingResponse = await fetch(upcomingUrl);
                if (!upcomingResponse.ok) throw new Error(`HTTP ${upcomingResponse.status}`);
                const upcomingData = await upcomingResponse.json();
                const upcomingGames = upcomingData.events?.filter(event => {
                    const competitors = event.competitions[0].competitors;
                    return competitors.some(c => c.rank && c.rank <= 25) || event.status.type.state === 'pre'; // Top 25 or scheduled games
                }) || [];

                if (upcomingGames.length === 0) {
                    // Fallback to scraping FBSchedules.com
                    try {
                        const fallbackUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://fbschedules.com/college-football-schedule/');
                        const fallbackResponse = await fetch(fallbackUrl);
                        if (!fallbackResponse.ok) throw new Error(`HTTP ${fallbackResponse.status}`);
                        const html = await fallbackResponse.text();
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        const games = doc.querySelectorAll('.schedule-game');
                        const fallbackGames = [];
                        games.forEach(game => {
                            const dateText = game.querySelector('.date')?.textContent.trim();
                            const date = new Date(dateText);
                            if (date >= currentDate && date <= futureDate) {
                                const homeTeam = game.querySelector('.home-team')?.textContent.trim() || 'Unknown';
                                const awayTeam = game.querySelector('.away-team')?.textContent.trim() || 'Unknown';
                                const time = game.querySelector('.time')?.textContent.trim() || 'TBD';
                                const channel = game.querySelector('.tv')?.textContent.trim() || 'TBD';
                                fallbackGames.push({ homeTeam, awayTeam, time, channel });
                            }
                        });

                        upcomingContainer.innerHTML = fallbackGames.length === 0 ? '<p class="no-games">No big games scheduled this week.</p>' : '';
                        fallbackGames.forEach(game => {
                            const gameDiv = document.createElement('div');
                            gameDiv.className = 'game';
                            const away = `<div class="team away">${game.awayTeam}</div>`;
                            const vs = `<div class="vs">@</div>`;
                            const home = `<div class="team">${game.homeTeam}</div>`;
                            gameDiv.innerHTML = `
                                <div class="teams-container">${away} ${vs} ${home}</div>
                                <div class="info-container">
                                    <div class="time">Kickoff: ${game.time}</div>
                                    <div class="channel">Channel: ${game.channel}</div>
                                </div>
                            `;
                            upcomingContainer.appendChild(gameDiv);
                        });
                    } catch (fallbackError) {
                        console.error('Error fetching NCAA upcoming games from FBSchedules:', fallbackError);
                        upcomingContainer.innerHTML = '<p class="no-games">Error fetching upcoming games.</p>';
                    }
                } else {
                    upcomingContainer.innerHTML = '';
                    upcomingGames.forEach(event => {
                        const gameDiv = document.createElement('div');
                        gameDiv.className = 'game';
                        const homeTeam = event.competitions[0].competitors.find(c => c.homeAway === 'home');
                        const awayTeam = event.competitions[0].competitors.find(c => c.homeAway === 'away');
                        const awayLogo = awayTeam.team.logo || 'https://via.placeholder.com/40';
                        const homeLogo = homeTeam.team.logo || 'https://via.placeholder.com/40';
                        const awayRank = awayTeam.rank ? `#${awayTeam.rank}` : '';
                        const homeRank = homeTeam.rank ? `#${homeTeam.rank}` : '';
                        const awayRecord = formatRecord(awayTeam.records ? awayTeam.records[0]?.summary : '');
                        const homeRecord = formatRecord(homeTeam.records ? homeTeam.records[0]?.summary : '');
                        const away = `<div class="team away"><img src="${awayLogo}" alt="${awayTeam.team.displayName} logo"><span class="rank">${awayRank}</span>${awayTeam.team.displayName}<span class="record">${awayRecord}</span></div>`;
                        const vs = `<div class="vs">@</div>`;
                        const home = `<div class="team"><img src="${homeLogo}" alt="${homeTeam.team.displayName} logo"><span class="rank">${homeRank}</span>${homeTeam.team.displayName}<span class="record">${homeRecord}</span></div>`;
                        const time = formatEasternTime(event.date, 'ncaa');
                        const channel = event.competitions[0].broadcasts?.[0]?.names?.join(', ') || 'TBD';
                        gameDiv.innerHTML = `
                            <div class="teams-container">${away} ${vs} ${home}</div>
                            <div class="info-container">
                                <div class="time">${time}</div>
                                <div class="channel">Channel: ${channel}</div>
                            </div>
                        `;
                        upcomingContainer.appendChild(gameDiv);
                    });
                }
                if (document.getElementById('ncaa').classList.contains('active')) {
                    startAutoScroll('ncaa', 252000); // 252s for NCAA
                }
            } catch (error) {
                console.error('Error fetching NCAA upcoming games from ESPN:', error);
                // Fallback to FBSchedules.com
                try {
                    const fallbackUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://fbschedules.com/college-football-schedule/');
                    const fallbackResponse = await fetch(fallbackUrl);
                    if (!fallbackResponse.ok) throw new Error(`HTTP ${fallbackResponse.status}`);
                    const html = await fallbackResponse.text();
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const games = doc.querySelectorAll('.schedule-game');
                    const fallbackGames = [];
                    games.forEach(game => {
                        const dateText = game.querySelector('.date')?.textContent.trim();
                        const date = new Date(dateText);
                        if (date >= currentDate && date <= futureDate) {
                            const homeTeam = game.querySelector('.home-team')?.textContent.trim() || 'Unknown';
                            const awayTeam = game.querySelector('.away-team')?.textContent.trim() || 'Unknown';
                            const time = game.querySelector('.time')?.textContent.trim() || 'TBD';
                            const channel = game.querySelector('.tv')?.textContent.trim() || 'TBD';
                            fallbackGames.push({ homeTeam, awayTeam, time, channel });
                        }
                    });

                    upcomingContainer.innerHTML = fallbackGames.length === 0 ? '<p class="no-games">No big games scheduled this week.</p>' : '';
                    fallbackGames.forEach(game => {
                        const gameDiv = document.createElement('div');
                        gameDiv.className = 'game';
                        const away = `<div class="team away">${game.awayTeam}</div>`;
                        const vs = `<div class="vs">@</div>`;
                        const home = `<div class="team">${game.homeTeam}</div>`;
                        gameDiv.innerHTML = `
                            <div class="teams-container">${away} ${vs} ${home}</div>
                            <div class="info-container">
                                <div class="time">Kickoff: ${game.time}</div>
                                <div class="channel">Channel: ${game.channel}</div>
                            </div>
                        `;
                        upcomingContainer.appendChild(gameDiv);
                    });
                    if (document.getElementById('ncaa').classList.contains('active')) {
                        startAutoScroll('ncaa', 252000); // 252s for NCAA
                    }
                } catch (fallbackError) {
                    console.error('Error fetching NCAA upcoming games from FBSchedules:', fallbackError);
                    upcomingContainer.innerHTML = '<p class="no-games">Error fetching upcoming games.</p>';
                }
            }
        }

        async function fetchScores(league) {
            if (league === 'ncaa') {
                fetchNCAAGames();
                return;
            }
            const url = `https://site.api.espn.com/apis/site/v2/sports/${leagues[league]}/scoreboard`;
            try {
                const containerId = league === 'nfl' ? 'nfl-scores' : 'mlb-scores';
                const container = document.getElementById(containerId);
                if (!container) {
                    console.error(`Container not found for ${containerId}`);
                    return;
                }
                container.innerHTML = '';
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                const data = await response.json();
                const events = data.events || [];
                if (events.length === 0) {
                    container.innerHTML = '<p class="no-games">No games currently scheduled or in progress.</p>';
                    stopAutoScroll();
                    return;
                }
                events.forEach(event => {
                    const gameDiv = document.createElement('div');
                    gameDiv.className = 'game';
                    const homeTeam = event.competitions[0].competitors.find(c => c.homeAway === 'home');
                    const awayTeam = event.competitions[0].competitors.find(c => c.homeAway === 'away');
                    const awayLogo = awayTeam.team.logo || 'https://via.placeholder.com/40';
                    const homeLogo = homeTeam.team.logo || 'https://via.placeholder.com/40';
                    const isLive = event.status.type.state === 'in';
                    const isCompleted = event.status.type.state === 'post';
                    const isScheduled = event.status.type.state === 'pre';
                    const scoreClass = isLive ? 'score live' : 'score';
                    const awayRank = awayTeam.rank ? `#${awayTeam.rank}` : '';
                    const homeRank = homeTeam.rank ? `#${homeTeam.rank}` : '';
                    const awayRecord = formatRecord(awayTeam.records ? awayTeam.records[0]?.summary : '');
                    const homeRecord = formatRecord(homeTeam.records ? homeTeam.records[0]?.summary : '');
                    const away = `<div class="team away"><img src="${awayLogo}" alt="${awayTeam.team.displayName} logo"><span class="rank">${awayRank}</span>${awayTeam.team.displayName}<span class="record">${awayRecord}</span> <span class="${scoreClass}">${awayTeam.score || 0}</span></div>`;
                    const vs = `<div class="vs">@</div>`;
                    const home = `<div class="team"><img src="${homeLogo}" alt="${homeTeam.team.displayName} logo"><span class="rank">${homeRank}</span>${homeTeam.team.displayName}<span class="record">${homeRecord}</span> <span class="${scoreClass}">${homeTeam.score || 0}</span></div>`;
                    const gameStartTime = new Date(event.date);
                    const currentTime = new Date();
                    currentTime.setHours(22, 32, 0, 0); // 10:32 PM EDT, September 1, 2025
                    const showTime = isScheduled && gameStartTime > currentTime;
                    const time = showTime ? formatEasternTime(event.date, league) : '';
                    const channel = event.competitions[0].broadcasts?.[0]?.names?.join(', ') || 'TBD';
                    let status = isCompleted ? 'Final' : event.status.type.description;
                    let clock = (isCompleted || isScheduled) ? '' : event.status.displayClock || '';
                    let stats = '';
                    let graphic = '';
                    if (league === 'mlb' && isLive) {
                        const situation = event.competitions[0].situation || {};
                        const inning = situation.inning ? `${situation.inning}${situation.topInning ? 'th Top' : 'th Bot'}` : 'Live';
                        const count = (situation.balls != null && situation.strikes != null) ? `${situation.balls}-${situation.strikes} Count` : '';
                        const outs = situation.outs != null ? `${situation.outs} Out${situation.outs !== 1 ? 's' : ''}` : '';
                        const batter = situation.batter?.athlete?.displayName || 'Unknown';
                        const pitcher = situation.pitcher?.athlete?.displayName || 'Unknown';
                        status = inning;
                        stats = [count, outs, `Batter: ${batter}`, `Pitcher: ${pitcher}`].filter(s => s).join(', ');
                        const bases = {
                            first: situation.onFirst ? 'active' : '',
                            second: situation.onSecond ? 'active' : '',
                            third: situation.onThird ? 'active' : ''
                        };
                        graphic = `<svg class="diamond" viewBox="0 0 100 100">
                            <path d="M50 10 L90 50 L50 90 L10 50 Z" class="base ${bases.first}"/>
                            <path d="M50 20 L80 50 L50 80 L20 50 Z" class="base ${bases.second}"/>
                            <path d="M50 30 L70 50 L50 70 L30 50 Z" class="base ${bases.third}"/>
                        </svg>`;
                    } else if (league === 'nfl' && isLive) {
                        const situation = event.competitions[0].situation || {};
                        const quarter = situation.period ? `Q${situation.period}` : (event.status.type.description.toLowerCase().includes('overtime') ? 'OT' : 'Live');
                        const timeRemaining = clock ? `${clock}` : '';
                        status = quarter;
                        stats = timeRemaining ? `${timeRemaining}` : stats;
                    }
                    gameDiv.innerHTML = `
                        <div class="teams-container">${away} ${vs} ${home}</div>
                        <div class="info-container">
                            ${time ? `<div class="time">${time}</div>` : ''}
                            <div class="status">${status}</div>
                            <div class="channel">Channel: ${channel}</div>
                        </div>
                        ${stats ? `<div class="stats">${stats}</div>` : ''}
                        ${graphic}
                    `;
                    container.appendChild(gameDiv);
                });
                if (document.getElementById(league).classList.contains('active')) {
                    startAutoScroll(containerId, 252000); // 252s for NFL/MLB
                }
            } catch (error) {
                console.error(`Error fetching ${league} scores:`, error);
                const containerId = league === 'nfl' ? 'nfl-scores' : 'mlb-scores';
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = '<p class="no-games">Error fetching scores. Please try again later.</p>';
                }
                stopAutoScroll();
            }
        }

        function updateAll() {
            Object.keys(leagues).forEach(league => fetchScores(league));
        }

        document.querySelectorAll('.tabs .tab').forEach(tab => {
            tab.addEventListener('click', () => {
                stopAutoScroll(); // Stop any existing scroll
                document.querySelectorAll('.tabs .tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.league').forEach(l => l.classList.remove('active'));
                tab.classList.add('active');
                const activeLeague = tab.dataset.league;
                document.getElementById(activeLeague).classList.add('active');
                const activeContainerId = activeLeague === 'ncaa' ? 'ncaa' : activeLeague === 'nfl' ? 'nfl-scores' : 'mlb-scores';
                startAutoScroll(activeContainerId, 252000); // 252s for all tabs
            });
        });

        // Schedule updates
        setInterval(updateAll, 30000); // Update scores every 30 seconds

        // Initial fetch
        updateAll();

        // RSS ticker
        async function fetchRSSTicker() {
            const tickerSpan = document.querySelector('#ticker span');
            tickerSpan.innerHTML = 'Loading news ticker...';

            // Try Yahoo Sports RSS
            try {
                const yahooResponse = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https://sports.yahoo.com/rss/');
                if (!yahooResponse.ok) throw new Error(`HTTP ${yahooResponse.status}`);
                const yahooData = await yahooResponse.json();
                const yahooItems = yahooData.items?.slice(0, 20).map(item => item.title).join(' +++ ') || 'No news available';
                tickerSpan.innerHTML = yahooItems + ' +++ ';
                return;
            } catch (error) {
                console.error('Error fetching Yahoo RSS:', error);
            }

            // Fallback to ESPN RSS
            try {
                const espnResponse = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https://www.espn.com/espn/rss/news');
                if (!espnResponse.ok) throw new Error(`HTTP ${espnResponse.status}`);
                const espnData = await espnResponse.json();
                const espnItems = espnData.items?.slice(0, 20).map(item => item.title).join(' +++ ') || 'No news available';
                tickerSpan.innerHTML = espnItems + ' +++ ';
            } catch (error) {
                console.error('Error fetching ESPN RSS:', error);
                tickerSpan.innerHTML = 'Sports news unavailable +++ ';
            }
        }

        fetchRSSTicker();
        setInterval(fetchRSSTicker, 600000); // Refresh ticker every 10 minutes
    </script>
</body>
</html>
